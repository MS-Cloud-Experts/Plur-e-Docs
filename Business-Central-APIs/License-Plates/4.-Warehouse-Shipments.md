Para diseñar la fase de **Ventas** en Business Central utilizando **Warehouse Shipments** y **Warehouse Picks**, y considerando el manejo de **License Plates (LPs)** parciales, debemos pensar en un flujo claro que permita la flexibilidad en la selección y movimiento de los LPs, manteniendo la integridad del inventario y facilitando la trazabilidad.

A continuación te propongo un flujo conceptual paso a paso para ayudarte a estructurar la fase de ventas:

### 1. **Recepción y Creación de LPs (Fase Completa)**
Antes de llegar a la fase de ventas, durante el **Warehouse Receipt**, ya hemos creado LPs para los productos recibidos. Estos LPs contienen la cantidad total de los ítems que llegaron al almacén y han sido etiquetados.

**Ejemplo:**
Un LP puede haber sido creado con 100 unidades del producto A en una ubicación del almacén. Vamos a referirnos a este LP como **LP-001**.

### 2. **Creación del Pedido de Venta**
El proceso comienza con la creación de un **Pedido de Venta** en Business Central. Aquí se ingresan los productos y cantidades solicitadas por el cliente. Este pedido va a desencadenar las siguientes acciones en el sistema, preparando el almacén para ejecutar el envío de los productos.

**Ejemplo:**
El cliente ha solicitado 60 unidades del producto A, que está disponible en **LP-001**.

### 3. **Warehouse Shipments**
Un **Warehouse Shipment** será creado a partir del Pedido de Venta. Este documento representa el envío y sirve como base para gestionar el picking y el empaquetado.

El **Warehouse Shipment** necesita saber qué cantidad debe salir del almacén, pero no especifica aún desde qué LP se tomarán los ítems.

**Ejemplo:**
El Warehouse Shipment indicará que deben enviarse 60 unidades del producto A.

### 4. **Warehouse Picks (Selección de LPs para Picking)**
El **Warehouse Pick** es el documento que instruye al operador de almacén a seleccionar las unidades de los ítems que deben enviarse al cliente. Aquí es donde entra en juego la **selección de los LPs**.

#### Concepto Clave: **Split de LPs Parciales**
Dado que los LPs representan conjuntos de ítems, es posible que un LP tenga más ítems de los que necesitamos para un envío en particular. Aquí es donde entra la operación de **Split**.

#### Escenario 1: LP Completo
Si el LP tiene exactamente la cantidad solicitada, puedes usar ese LP completo sin realizar ninguna división.

#### Escenario 2: LP Parcial (Se Necesita un Split)
Si el LP tiene más unidades de las que necesitamos para este envío, se debe hacer un **Split**. Esta operación dividirá el LP original en dos:

- **LP-001** (nuevo): El LP con la cantidad que debe enviarse.
- **LP-002** (nuevo): El LP con la cantidad restante que no será enviado.

**Ejemplo:**
Si tienes **LP-001** con 100 unidades, y necesitas enviar solo 60, haces un **Split**:
- **LP-001**: 60 unidades para el envío.
- **LP-002**: 40 unidades que permanecerán en el almacén.

### 5. **Asignación de LPs al Warehouse Pick**
En esta etapa, el sistema seleccionará los LPs que mejor correspondan a la cantidad solicitada en el pedido. Dependiendo de si fue necesario realizar un split o no, el **Warehouse Pick** se actualizará con la referencia a los LPs.

- Si no fue necesario hacer un split, simplemente asigna el LP original.
- Si se hizo un split, el **Warehouse Pick** asignará el LP nuevo que tiene la cantidad exacta para el envío.

### 6. **Actualización del Inventario**
Una vez que el **Warehouse Pick** ha sido completado (es decir, el operador ha seleccionado los ítems y los ha preparado para el envío), el inventario de Business Central se actualizará, reflejando las cantidades correctas en cada LP:

- El LP seleccionado para el envío será marcado como "Picked" y luego como "Shipped" una vez se complete el envío.
- Si se realizó un **Split**, los LPs resultantes serán actualizados con las cantidades correctas. Uno de los LPs (el que fue enviado) cambiará de estado a **Shipped**, mientras que el otro permanecerá en su ubicación con el estado **Stored**.

### 7. **Proceso de Empaque y Envío (Packed y Shipped)**
Finalmente, los productos seleccionados en el **Warehouse Pick** se empaquetarán y se asociarán al **Warehouse Shipment** para completar el proceso de ventas.

- **Packed**: Una vez que los ítems han sido empaquetados, el estado del LP puede cambiar a **Packed**.
- **Shipped**: Cuando el envío es completado, el estado final del LP será **Shipped**.

### 8. **Trazabilidad Completa con LP Movements**
Durante todo este proceso, cada movimiento de los LPs (incluyendo los **Splits** y **Pickings**) será registrado en la tabla de **LP Movements**, asegurando una trazabilidad completa. Esto permite que, en cualquier momento, se pueda auditar qué LPs fueron divididos, cuáles fueron enviados, y cuáles permanecen en el almacén.

### Consideración para **Assemblies (Kits)**
En procesos de venta donde se construyen **Kits** (conjuntos de productos), se requiere un mecanismo que permita buscar sustitutos automáticamente si un componente del kit no está disponible. Esto puede incluir dividir un LP si solo hay una parte de los componentes necesarios en un LP específico o buscar en otros LPs.

**Ejemplo:**
Si un Kit necesita 50 unidades del producto A y 50 del producto B, pero el producto B está parcialmente en dos LPs distintos, se puede realizar un split para cumplir con la demanda y permitir que el Kit se complete.

---

### **Resumen Conceptual del Proceso de Ventas con LPs:**

1. **Pedido de Venta**: Se genera un pedido con la cantidad solicitada por el cliente.
2. **Warehouse Shipment**: Se crea el documento de envío que indica la cantidad total a enviar.
3. **Warehouse Pick**: Se seleccionan los LPs, utilizando splits si es necesario para enviar cantidades parciales.
4. **Split de LPs**: Se divide un LP si contiene más unidades de las necesarias.
5. **Asignación de LPs**: Se asignan los LPs correctos para el envío, actualizando el inventario.
6. **Empaque y Envío**: Los productos son empaquetados y enviados, marcando los LPs como "Packed" y luego "Shipped".
7. **Registro de Movimientos**: Se registran todos los movimientos y splits de LPs en la tabla de **LP Movements** para asegurar trazabilidad.

Este enfoque garantiza que los LPs se gestionen de manera eficiente durante el proceso de ventas, con flexibilidad para manejar LPs parciales y asegurar la integridad del inventario.

[[_TOSP_]]